<div class="modern-form-container">
  <div class="modern-form-wrapper">
    <div class="modern-form-header">
      <h2 class="modern-form-title">
        <fa-icon icon="credit-card" class="me-2 text-primary"></fa-icon>
        <span appTranslate="longonkeloApp.conta.home.createOrEditLabel">Criar ou editar Conta</span>
      </h2>
    </div>

    <form name="editForm" role="form" novalidate (ngSubmit)="save()" [formGroup]="editForm" class="modern-form">
      <app-alert-error></app-alert-error>

      <!-- ID Field (Only for Edit Mode) -->
      <div class="row mb-3" *ngIf="editForm.controls.id.value !== null">
        <div class="col-12">
          <label class="form-label" appTranslate="global.field.id" for="field_id">
            <fa-icon icon="key" class="me-2 text-secondary"></fa-icon>ID
          </label>
          <input type="number" class="form-control" name="id" id="field_id" data-cy="id" formControlName="id" [readonly]="true" />
        </div>
      </div>

      <!-- Section 1: Account Visual -->
      <fieldset class="modern-form-section">
        <legend class="modern-form-section-title">
          <fa-icon icon="image" class="section-icon"></fa-icon>
          Imagem da Conta
        </legend>
        <div class="modern-form-section-content">
          <div class="row">
            <div class="col-12">
              <label class="form-label" appTranslate="longonkeloApp.conta.imagem" for="field_imagem">
                <fa-icon icon="camera" class="me-2 text-info"></fa-icon>Imagem
              </label>
              <div class="image-upload-container">
                <div class="image-preview" *ngIf="editForm.get('imagem')!.value">
                  <img
                    [src]="'data:' + editForm.get('imagemContentType')!.value + ';base64,' + editForm.get('imagem')!.value"
                    class="preview-image"
                    alt="conta image"
                  />
                  <div class="image-info">
                    <span class="file-info"
                      >{{ editForm.get('imagemContentType')!.value }}, {{ byteSize(editForm.get('imagem')!.value!) }}</span
                    >
                    <button
                      type="button"
                      (click)="clearInputImage('imagem', 'imagemContentType', 'file_imagem')"
                      class="btn btn-outline-danger btn-sm"
                      title="Remover imagem"
                    >
                      <fa-icon icon="times"></fa-icon>
                    </button>
                  </div>
                </div>
                <div class="file-input-wrapper">
                  <input
                    type="file"
                    id="file_imagem"
                    data-cy="imagem"
                    (change)="setFileData($event, 'imagem', true)"
                    accept="image/*"
                    class="file-input"
                  />
                  <label for="file_imagem" class="file-input-label">
                    <fa-icon icon="upload" class="me-2"></fa-icon>
                    <span appTranslate="entity.action.addimage">Escolher imagem</span>
                  </label>
                </div>
              </div>
              <input type="hidden" class="form-control" name="imagem" id="field_imagem" data-cy="imagem" formControlName="imagem" />
              <input
                type="hidden"
                class="form-control"
                name="imagemContentType"
                id="field_imagemContentType"
                formControlName="imagemContentType"
              />
            </div>
          </div>
        </div>
      </fieldset>

      <!-- Section 2: Account Classification -->
      <fieldset class="modern-form-section">
        <legend class="modern-form-section-title">
          <fa-icon icon="tags" class="section-icon"></fa-icon>
          Classificação da Conta
        </legend>
        <div class="modern-form-section-content">
          <div class="row">
            <div class="col-md-6">
              <label class="form-label" appTranslate="longonkeloApp.conta.tipo" for="field_tipo">
                <fa-icon icon="bookmark" class="me-2 text-primary"></fa-icon>Tipo
              </label>
              <select class="form-select" name="tipo" formControlName="tipo" id="field_tipo" data-cy="tipo">
                <option [ngValue]="null">{{ 'longonkeloApp.TipoConta.null' | translate }}</option>
                <option *ngFor="let tipoConta of tipoContaValues" [value]="tipoConta">
                  {{ 'longonkeloApp.TipoConta.' + tipoConta | translate }}
                </option>
              </select>
              <div *ngIf="editForm.get('tipo')!.invalid && (editForm.get('tipo')!.dirty || editForm.get('tipo')!.touched)">
                <small
                  class="form-text text-danger"
                  *ngIf="editForm.get('tipo')?.errors?.required"
                  appTranslate="entity.validation.required"
                >
                  O campo é obrigatório.
                </small>
              </div>
            </div>
            <div class="col-md-6">
              <label class="form-label" appTranslate="longonkeloApp.conta.titulo" for="field_titulo">
                <fa-icon icon="heading" class="me-2 text-primary"></fa-icon>Título
              </label>
              <input type="text" class="form-control" name="titulo" id="field_titulo" data-cy="titulo" formControlName="titulo" />
              <div *ngIf="editForm.get('titulo')!.invalid && (editForm.get('titulo')!.dirty || editForm.get('titulo')!.touched)">
                <small
                  class="form-text text-danger"
                  *ngIf="editForm.get('titulo')?.errors?.required"
                  appTranslate="entity.validation.required"
                >
                  O campo é obrigatório.
                </small>
              </div>
            </div>
          </div>
        </div>
      </fieldset>

      <!-- Section 3: Account Details -->
      <fieldset class="modern-form-section">
        <legend class="modern-form-section-title">
          <fa-icon icon="university" class="section-icon"></fa-icon>
          Detalhes Bancários
        </legend>
        <div class="modern-form-section-content">
          <div class="row">
            <div class="col-md-6">
              <label class="form-label" appTranslate="longonkeloApp.conta.numero" for="field_numero">
                <fa-icon icon="hashtag" class="me-2 text-success"></fa-icon>Número da Conta
              </label>
              <input type="text" class="form-control" name="numero" id="field_numero" data-cy="numero" formControlName="numero" />
              <div *ngIf="editForm.get('numero')!.invalid && (editForm.get('numero')!.dirty || editForm.get('numero')!.touched)">
                <small
                  class="form-text text-danger"
                  *ngIf="editForm.get('numero')?.errors?.required"
                  appTranslate="entity.validation.required"
                >
                  O campo é obrigatório.
                </small>
              </div>
            </div>
            <div class="col-md-6">
              <label class="form-label" appTranslate="longonkeloApp.conta.iban" for="field_iban">
                <fa-icon icon="barcode" class="me-2 text-success"></fa-icon>IBAN
              </label>
              <input type="text" class="form-control" name="iban" id="field_iban" data-cy="iban" formControlName="iban" />
              <div *ngIf="editForm.get('iban')!.invalid && (editForm.get('iban')!.dirty || editForm.get('iban')!.touched)">
                <!-- Validation messages for IBAN if needed -->
              </div>
            </div>
          </div>
          <div class="row">
            <div class="col-12">
              <label class="form-label" appTranslate="longonkeloApp.conta.titular" for="field_titular">
                <fa-icon icon="user" class="me-2 text-success"></fa-icon>Titular da Conta
              </label>
              <input type="text" class="form-control" name="titular" id="field_titular" data-cy="titular" formControlName="titular" />
              <div *ngIf="editForm.get('titular')!.invalid && (editForm.get('titular')!.dirty || editForm.get('titular')!.touched)">
                <small
                  class="form-text text-danger"
                  *ngIf="editForm.get('titular')?.errors?.required"
                  appTranslate="entity.validation.required"
                >
                  O campo é obrigatório.
                </small>
              </div>
            </div>
          </div>
        </div>
      </fieldset>

      <!-- Section 4: Configuration -->
      <fieldset class="modern-form-section">
        <legend class="modern-form-section-title">
          <fa-icon icon="cogs" class="section-icon"></fa-icon>
          Configuração
        </legend>
        <div class="modern-form-section-content">
          <div class="row">
            <div class="col-md-6">
              <label class="form-label" appTranslate="longonkeloApp.conta.moeda" for="field_moeda">
                <fa-icon icon="dollar-sign" class="me-2 text-warning"></fa-icon>Moeda
              </label>
              <select
                class="form-select"
                id="field_moeda"
                data-cy="moeda"
                name="moeda"
                formControlName="moeda"
                [compareWith]="compareLookupItem"
              >
                <option [ngValue]="null">Selecionar moeda...</option>
                <option [ngValue]="lookupItemOption" *ngFor="let lookupItemOption of lookupItemsSharedCollection">
                  {{ lookupItemOption.descricao }}
                </option>
              </select>
            </div>
            <div class="col-md-6 d-flex align-items-end">
              <div class="form-check form-switch">
                <input
                  type="checkbox"
                  class="form-check-input"
                  name="isPadrao"
                  id="field_isPadrao"
                  data-cy="isPadrao"
                  formControlName="isPadrao"
                />
                <label class="form-check-label" appTranslate="longonkeloApp.conta.isPadrao" for="field_isPadrao">
                  <fa-icon icon="star" class="me-2 text-warning"></fa-icon>Conta Padrão
                </label>
              </div>
            </div>
          </div>
        </div>
      </fieldset>

      <!-- Form Actions -->
      <div class="modern-form-actions">
        <button
          type="button"
          id="cancel-save"
          data-cy="entityCreateCancelButton"
          class="btn btn-outline-secondary"
          (click)="previousState()"
        >
          <fa-icon icon="ban" class="me-2"></fa-icon>
          <span appTranslate="entity.action.cancel">Cancelar</span>
        </button>

        <button
          type="submit"
          id="save-entity"
          data-cy="entityCreateSaveButton"
          [disabled]="editForm.invalid || isSaving"
          class="btn btn-primary"
        >
          <fa-icon icon="save" class="me-2"></fa-icon>
          <span appTranslate="entity.action.save">Guardar</span>
        </button>
      </div>
    </form>
  </div>
</div>
